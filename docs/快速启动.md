# 快速启动指南

## 前置要求

- Node.js >= 18
- Docker Desktop（用于本地邮件服务器）

## 1. 安装依赖

```bash
npm install
```

## 2. 启动本地邮件服务器（可选）

```bash
# 启动 Mailpit
docker-compose up -d mailpit

# 查看状态
docker-compose ps

# 访问 Web UI
open http://localhost:8026
```

## 3. 启动开发服务器

```bash
npm run dev
```

这将：
1. 启动 Vite 开发服务器（http://localhost:5173）
2. 构建主进程和预加载脚本
3. 自动打开 Electron 应用窗口

## 4. 验证运行状态

### 应该看到的窗口

Electron 应用窗口应该包含：
- **顶部标题栏**: 窗口控制按钮 + 导航按钮 + 地址栏 + 捕获按钮
- **左侧边栏**: 文摘列表（初始为空）+ 搜索框 + 同步按钮
- **右侧区域**: 浏览器视图（BrowserView）

### 初次使用

1. **测试浏览功能**:
   - 在地址栏输入：`https://www.example.com`
   - 按回车或点击前进按钮

2. **测试捕获功能**:
   - 浏览到任意网页
   - 点击"捕获"按钮
   - 内容将保存到侧边栏

3. **查看本地数据**:
   ```bash
   # 数据存储位置（macOS）
   ~/Library/Application Support/email-digest/data/
   ```

## 5. 配置邮箱（可选）

如果要测试邮件功能：

1. 确保 Mailpit 正在运行
2. 在应用设置中配置：

**SMTP 配置**:
```
主机: localhost
端口: 1026
安全连接: 关闭
用户名: test@example.com
密码: any
```

**IMAP 配置**:
```
主机: localhost
端口: 1143
安全连接: 关闭
用户名: test@example.com
密码: any
文件夹: INBOX
```

3. 捕获一个页面后，应用会自动发送到 Mailpit
4. 访问 http://localhost:8026 查看邮件
5. 点击"同步邮箱"按钮从 Mailpit 读取邮件

## 常见问题

### 端口被占用

如果看到 `Port 5173 is in use`，Vite 会自动使用下一个端口（5174）。

### dragEvent 错误

控制台可能显示：`ReferenceError: dragEvent is not defined`

这是 Electron 开发工具的已知问题，可以安全忽略，不影响功能。

### Electron 窗口没有打开

1. 检查终端是否有错误
2. 确认 dist 目录已生成：
   ```bash
   ls -la dist/
   ```
3. 重启开发服务器：
   ```bash
   # 按 Ctrl+C 停止，然后
   npm run dev
   ```

### GPU 进程错误

可能看到 GPU 相关警告，这是 Electron 在某些系统上的正常现象，不影响功能。

### 无法加载页面

确保：
1. Vite 开发服务器正在运行（看到 `Local: http://localhost:5173/`）
2. 主进程和预加载脚本已构建（看到 `dist/main/index.js` 和 `dist/preload/preload.js`）

## 开发提示

### 热重载

- **渲染进程**: 修改 `src/renderer/` 下的文件会自动热重载
- **主进程**: 修改 `src/main/` 下的文件会自动重新构建并重启 Electron

### 开发者工具

Electron 窗口会自动打开 DevTools。如果关闭了：
- macOS: `Cmd + Option + I`
- Windows/Linux: `Ctrl + Shift + I`

### 查看日志

- **渲染进程**: DevTools Console
- **主进程**: 终端输出

### 重置数据

```bash
# macOS
rm -rf ~/Library/Application\ Support/email-digest/

# Windows
# 删除 %APPDATA%\email-digest

# Linux
rm -rf ~/.config/email-digest/
```

## 停止服务

```bash
# 停止开发服务器
Ctrl + C

# 停止邮件服务器
docker-compose down
```

## 下一步

- 阅读 [开发指南](./开发指南.md) 了解项目结构
- 查看 [功能模式说明](./功能模式说明.md) 了解不同使用模式
- 参考 [本地邮件服务器](./本地邮件服务器.md) 配置邮件测试

## 获取帮助

- 查看文档: `docs/` 目录
- 查看代码注释
- GitHub Issues: https://github.com/minghua-li/email-digest/issues
